报表生成器 (终极全自动版) 使用手册
🚀 简介
这份工具是为了实现数据报表流程的全自动化而设计的。它每天只需要运行两个脚本（三个步骤），就能自动抓取在线消耗数据、合并本地下载的运营数据，并生成包含产品、部门和渠道三个维度的日报、周报和月报。

您只需要负责：下载四个源文件和运行两个脚本。

第一步：环境配置 (仅需执行一次)
要运行 Python 脚本，您的电脑需要安装 Python 环境和必需的数据处理库。

1. 安装 Python (如果未安装)
请确保您的电脑安装了 Python 3.8 或更高版本。

2. 安装所需的库
打开您的命令行工具（如 Windows 的 PowerShell 或 CMD），输入以下命令安装核心库 pandas，它会自动安装所有依赖项：

pip install pandas openpyxl

3. 设置项目文件夹
请确保您的项目文件夹中包含以下两个脚本文件：

auto_report.py (负责下载四个原始数据文件)

report_generator.py (核心的合并和计算脚本)

第二步：日常工作流程 (每日操作)
您的日常工作流程被简化为以下三个步骤：

步骤

动作

命令

目的

1. 下载

运行下载脚本

python auto_report.py

自动下载今日所需的 4 个原始文件。

2. 移动

将 4 个文件移动到项目文件夹

手动操作

确保生成器能找到所有原始数据。

3. 生成

运行报表生成器

python report_generator.py

自动合并所有数据并生成最终报表。

执行步骤 3 后，您将在项目文件夹中看到最终文件：最终生成三维度报表.xlsx。

第三步：生成的报表清单
最终的 Excel 文件 (最终生成三维度报表.xlsx) 包含以下 11 个 Sheet：

维度

报表类型

Sheet 名称

描述

产品

日报 / 周报总汇 / 月报总汇

产品-日报, 产品-周报总汇, 产品-月报总汇

产品维度的每日、每周汇总、每月汇总数据。

部门

日报 / 周报总汇 / 月报总汇

部门-日报, 部门-周报总汇, 部门-月报总汇

部门维度的每日、每周汇总、每月汇总数据。

渠道

日报 / 周报总汇 / 月报总汇

渠道-日报, 渠道-周报总汇, 渠道-月报总汇

渠道维度的每日、每周汇总、每月汇总数据。

产品

周报对比 / 月报对比

产品周报表, 产品月报表

特殊报表：包含本期、上期和环比对比数据。

疑难解答 (常见问题)
问题描述

错误信息示例

解决方法

报表生成失败

[致命错误] 渠道报表是基础数据源，请确保文件存在...

检查步骤 2： 确保您已经将所有 4 个文件从下载目录移动到了 report_generator.py 所在的文件夹。

文件读取失败

[错误] 文件读取失败: 所有尝试的编码 (...) 都未能成功解析文件

无需担心，这是自动修复的。 脚本会自动尝试将文件作为 Excel 格式读取（因为您的源文件编码特殊），如果出现此警告，但看到 [成功] CSV 编码失败，但以 Excel 格式读取成功，则表示读取成功。

想调整汇率

无错误信息

高级设置： 打开 report_generator.py，在顶部找到配置区 (# ==================== 终极配置区 ====================)，修改 EXCHANGE_RATE 的值即可。

想调整消耗链接

无错误信息

高级设置： 打开 report_generator.py，在配置区修改 SPEND_SHEET_URL 的值即可。

Python 报错

出现 AttributeError 或其他复杂报错

请将完整的命令行报错信息截图发送给负责 Python 脚本维护的同事（即我），以进行代码层面的修复。

